---
title: "Yahoo_Realtime"
author: "Jasmine Hao"
date: "November 13, 2018"
output:
  md_document:
    variant: markdown_github
    
---

```{r setup, include=FALSE}
library(rvest)
library(httr)
library(dplyr)
library(stringr)
library(XML)
library(RCurl)
```


```{r data}
url_crypto <-"https://ca.finance.yahoo.com/cryptocurrencies"
url_commo <- "https://ca.finance.yahoo.com/commodities"
url_curr <- "https://ca.finance.yahoo.com/currencies"
i = 0 
currency_price <- data.frame()
time_list <- c()
while (i < 10){
  web_page_parsed <- htmlParse(GET(url_curr), encoding = "UTF-8")
  table <- readHTMLTable(web_page_parsed)
  table <- table[[1]][,1:3]
  names(table) <- c("Symb","Name","price")
  price_list <-as.numeric(strsplit(toString(table$price),",")[[1]])[1:28]
  name_list <- strsplit(toString(table$Name),",")[[1]][1:28]
  # names(price_list) <- name_list
  currency_price <- rbind(currency_price,price_list)
  colnames(currency_price) <- name_list
  time_list <- c(time_list,toString(Sys.time()))
  Sys.sleep(5)
  i = i + 1
}
currency_price$time <- time_list
print(head(currency_price))
```

```{r}
library(ggplot2)
library(reshape)
price_plot <- melt(currency_price,"time")
ggplot2::ggplot(price_plot,aes(x = time, y = value, 
                                  group = variable, color = variable)) + geom_line(size = 1.2, alpha = 0.5) 
```

![](Yahoo_realtime_files/figure-markdown_github/GBP_USD.png)
![](Yahoo_realtime_files/figure-markdown_github/GBP_JPY.png)
